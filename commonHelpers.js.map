{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '36399234-af15385039238a4844768ffbd';\n\nclass NewApiSearch {\n  constructor() {\n    this.searchQuery = '';\n    this.queryPage = 1;\n    this.perPage = 15;\n  }\n\n  async getNews() {\n    const response = await axios.get('', {\n      params: {\n        key: API_KEY,\n        q: this.searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: this.perPage,\n        page: this.queryPage,\n      },\n    });\n\n    this.incrementPage();\n    return response.data;\n  }\n\n  resetPage() {\n    this.queryPage = 1;\n  }\n\n  incrementPage() {\n    this.queryPage += 1;\n  }\n}\n\nexport { NewApiSearch };\n","function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"list-item\">\n                    <a class=\"list-link\" href=\"${largeImageURL}\"><img class=\"list-img\" src=\"${webformatURL}\" alt=\"${tags}\"/></a>\n                    <div class=\"list-conteiner\">\n                        <div class=\"list-wrappar\">\n                            <b class=\"list-pretext\">Likes</b>\n                            <p class=\"list-text\">${likes}</p>\n                        </div>\n                        <div class=\"list-wrappar\">\n                            <b class=\"list-pretext\">Views</b>\n                            <p class=\"list-text\">${views}</p>\n                        </div>\n                        <div class=\"list-wrappar\">\n                            <b class=\"list-pretext\"> Comments</b>\n                            <p class=\"list-text\">${comments}</p>\n                        </div>\n                        <div class=\"list-wrappar\">\n                            <b class=\"list-pretext\"> Downloads</b>\n                            <p class=\"list-text\">${downloads}</p>\n                        </div>\n                    </div>\n                </li>`;\n      }\n    )\n    .join('');\n}\n\nexport { createMarkup };\n","import { NewApiSearch } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst newApiSearch = new NewApiSearch();\n\nconst refs = {\n  formSearch: document.querySelector('.form'),\n  listForm: document.querySelector('.list-form'),\n  spinner: document.querySelector('.conteiner-loader'),\n  btnLoadMore: document.querySelector('.button-loadMore'),\n  textLoading: document.querySelector('.text-load'),\n};\n\nrefs.formSearch.addEventListener('submit', onFormSearch);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreSearch);\n\n// spinnerHide();\n\nasync function onFormSearch(e) {\n  e.preventDefault();\n\n  newApiSearch.searchQuery = e.currentTarget.elements.searchQuery.value.trim();\n  onHideLoadBtn();\n  onShowTextStatusLoading();\n  clearNewList();\n  newApiSearch.resetPage();\n\n  try {\n    const { hits } = await newApiSearch.getNews(newApiSearch.searchQuery);\n\n    if (!hits.length || !newApiSearch.searchQuery) {\n      throw new Error('No more data');\n    }\n\n    refs.listForm.innerHTML = createMarkup(hits);\n\n    if (newApiSearch.perPage > hits.length) {\n      throw new Error('Data end!');\n    } else {\n      onHideTextStatusLoading();\n      onShowLoadMoreBtn();\n\n      gallery.refresh();\n    }\n  } catch (error) {\n    if (error.message === 'Data end!') {\n      errorEndApi();\n    } else {\n      errorSearch();\n    }\n  } finally {\n    clearFormSearch();\n  }\n}\n\nasync function onLoadMoreSearch() {\n  onShowTextStatusLoading();\n  onHideLoadBtn();\n\n  try {\n    const { hits, totalHits } = await newApiSearch.getNews(\n      newApiSearch.searchQuery\n    );\n    const totalPage = Math.ceil(totalHits / hits.length);\n    console.log(totalPage);\n    if (totalPage === newApiSearch.queryPage) {\n      throw new Error('Data end!');\n    }\n\n    refs.listForm.insertAdjacentHTML('beforeend', createMarkup(hits));\n    windowScroll();\n    onHideTextStatusLoading();\n    onShowLoadMoreBtn();\n\n    gallery.refresh();\n  } catch {\n    errorEndApi();\n  }\n}\n\nfunction clearFormSearch() {\n  refs.formSearch.reset();\n}\n\nfunction clearNewList() {\n  refs.listForm.innerHTML = '';\n}\n\n// Error status\n\nfunction errorSearch() {\n  iziToast.error({\n    position: 'topRight',\n    title: 'Error Search',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n\n  //   spinnerHide();\n  onHideTextStatusLoading();\n  onHideLoadBtn();\n}\n\nfunction errorEndApi() {\n  iziToast.info({\n    position: 'topRight',\n    title: 'Error End API Search',\n    message: 'We`re sorry, but you`ve reached the end of search results.',\n  });\n  onHideTextStatusLoading();\n  onHideLoadBtn();\n}\n\n// Status spinner\n\n// function spinnerHide() {\n//   refs.spinner.classList.add('hidden');\n// }\n\n// function spinnerShow() {\n//   refs.spinner.classList.remove('hidden');\n// }\n\n// Status Button load More\n\nfunction onShowLoadMoreBtn() {\n  refs.btnLoadMore.classList.remove('hidden');\n}\n\nfunction onHideLoadBtn() {\n  refs.btnLoadMore.classList.add('hidden');\n}\n\n// Status text loading\n\nfunction onShowTextStatusLoading() {\n  refs.textLoading.classList.remove('hidden');\n}\n\nfunction onHideTextStatusLoading() {\n  refs.textLoading.classList.add('hidden');\n}\n\n// Window Scroll\n\nfunction windowScroll() {\n  const cardHeight = document\n    .querySelector('.list-item')\n    .getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","API_KEY","NewApiSearch","response","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","gallery","SimpleLightbox","newApiSearch","refs","onFormSearch","onLoadMoreSearch","e","onHideLoadBtn","onShowTextStatusLoading","clearNewList","hits","onHideTextStatusLoading","onShowLoadMoreBtn","error","errorEndApi","errorSearch","clearFormSearch","totalHits","totalPage","windowScroll","iziToast","cardHeight"],"mappings":"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"}